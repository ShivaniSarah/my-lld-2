package org.example;

import java.io.File;
import java.util.*;



public class Main {

static class StudentMarks{
    String roll;
    String name;
    int totalMarks;

    public StudentMarks(String roll, String name, int totalMarks) {
        this.roll = roll;
        this.name = name;
        this.totalMarks = totalMarks;
    }

    @Override
    public String toString() {
        return "Roll: "+roll + "  Name: " + name+" TotalMarks:  "+ totalMarks;
    }
}
    static List<StudentMarks> printTopStudentsByTotalMarks(List<List<String>> studentsList, List<List<String>> marksList, int maxCount) {

        Map<String, String> rollToName = new HashMap<>();
        for(List<String> row: studentsList){
            if(row.size()<2) continue;
            String roll = row.get(0).trim();
            String name = row.get(1).trim();
            rollToName.put(roll,name);
        }

        Map<String,Integer> rollToMarks = new HashMap<>();
        for(List<String> row:marksList ){
            if(row.size()<3) continue;
            String roll = row.get(1).trim();
            int marks = Integer.parseInt(row.get(2).trim());
            rollToMarks.put(roll, rollToMarks.getOrDefault(roll,0)+marks);
        }

        List<StudentMarks> resultStudentList = new ArrayList<>();

        PriorityQueue<StudentMarks> pq = new PriorityQueue<>(Comparator.comparingInt(m-> m.totalMarks));

        for(Map.Entry<String,Integer> entry : rollToMarks.entrySet()){
            String roll = entry.getKey();
            int totalMarks = entry.getValue();
            String name = rollToName.get(roll);
            StudentMarks sm = new StudentMarks(roll,name,totalMarks);
            pq.offer(sm);
            if(pq.size()>maxCount){
                pq.poll();
            }
        }

        List<StudentMarks> result = new ArrayList<>();
        while(!pq.isEmpty()){
            result.add(pq.poll());
        }

        Collections.reverse(result);

        return result;

    }


    public static void main(String[] args) {

List<List<String>> studentList =  Arrays.asList(
        Arrays.asList("1","Shivani"),
        Arrays.asList("2","Sara"),
        Arrays.asList("3","Shivam"),
        Arrays.asList("4","Shia"),
        Arrays.asList("5","Shiv")

);

        List<List<String>> marksList =  Arrays.asList(
                Arrays.asList("maths","2","80"),
                Arrays.asList("english","2","60"),
                Arrays.asList("maths","1","80"),
                Arrays.asList("english","1","60"),
                Arrays.asList("maths","3","80"),
                Arrays.asList("english","3","60"),
                Arrays.asList("maths","4","80"),
                Arrays.asList("english","4","60"),
                Arrays.asList("maths","5","80"),
                Arrays.asList("english","5","60"),
                Arrays.asList("science","2","80"),
                Arrays.asList("science","2","60"),
                Arrays.asList("science","3","100")

        );



        List<StudentMarks> result =  printTopStudentsByTotalMarks(studentList, marksList,2);
//        System.out.println("Hello world!");

        System.out.println("Top Students by marks");
        for(StudentMarks sm : result){
            System.out.println(sm);
        }


    }
}
